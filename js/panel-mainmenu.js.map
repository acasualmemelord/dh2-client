{"version":3,"file":"panel-mainmenu.js","names":["MainMenuRoom","_PSRoom","_inheritsLoose","_this","_len","arguments","length","args","Array","_key","call","apply","concat","classType","userdetailsCache","roomsCache","_proto","prototype","receiveLine","_this2","cmd","challstr","PSLoginServer","query","act","then","res","loggedin","send","username","assertion","fullName","namedCode","avatar","PS","user","setName","challengesBuf","receiveChallenges","queryId","responseJSON","handleQueryResponse","JSON","parse","user1","user2","message","handlePM","parseFormats","alert","replace","lobby","rooms","dataBuf","json","_unused","userid","challengesFrom","getPMRoom","toID","challengeTo","to","roomid","_json$challengeTo","_json$challengeTo2","room","pmTarget","targetUserid","challengedFormat","challengingFormat","format","update","formatsList","isSection","section","column","window","NonBattleGames","rps","BattleFormats","j","entry","teams","usesLocalLadder","charAt","isNaN","Number","slice","parseInt","_BattleFormats$_id","name","searchShow","challengeShow","tournamentShow","team","teambuilderLevel","lastCommaIndex","lastIndexOf","code","substr","NaN","id","isTeambuilderFormat","teambuilderFormat","teambuilderFormatName","parenPos","indexOf","trim","rated","effectType","multivariantFormats","battleFormat","userid1","userid2","sort","join","addRoom","response","userdetails","Object","assign","userRoom","roomsRoom","battlesRoom","battleTable","battles","battleid","push","PSRoom","NewsPanel","_PSRoomPanel","_proto2","render","preact","h","PSPanelWrapper","props","scrollable","dangerouslySetInnerHTML","__html","newsHTML","PSRoomPanel","MainMenuPanel","_PSRoomPanel2","_this3","_len2","_key2","submit","e","_proto3","focus","base","querySelector","renderMiniRoom","roomType","roomTypes","type","Panel","Component","key","renderMiniRooms","_this4","miniRoomList","map","value","tabIndex","title","onlineButton","isOffline","searchButton","down","style","textAlign","width","height","src","Config","routes","client","alt","TeamForm","onSubmit","display","leftRoomWidth","server","href","dex","target","replays","root","FormatDropdown","_preact$Component","_this5","_len3","_key3","change","forceUpdate","onChange","_proto4","disabled","TeamDropdown","_preact$Component2","_this6","_len4","_key4","teamFormat","teamKey","_proto5","getDefaultTeam","_i2","_PS$teams$list2","list","_window$BattleFormats","formatData","Dex","getPokemonIcon","byKey","TeamBox","noLink","_preact$Component3","_this7","_len5","_key5","state","changeFormat","setState","preventDefault","undefined","_proto6","children","Model"],"sources":["../src/panel-mainmenu.tsx"],"sourcesContent":["/**\r\n * Main menu panel\r\n *\r\n * @author Guangcong Luo <guangcongluo@gmail.com>\r\n * @license AGPLv3\r\n */\r\n\r\ntype RoomInfo = {title: string, desc?: string, userCount?: number, subRooms?: string[]};\r\n\r\nclass MainMenuRoom extends PSRoom {\r\n\treadonly classType: string = 'mainmenu';\r\n\tuserdetailsCache: {[userid: string]: {\r\n\t\tuserid: ID,\r\n\t\tavatar?: string | number,\r\n\t\tstatus?: string,\r\n\t\tgroup?: string,\r\n\t\t// customgroup?: string,\r\n\t\trooms?: {[roomid: string]: {isPrivate?: true, p1?: string, p2?: string}},\r\n\t}} = {};\r\n\troomsCache: {\r\n\t\tbattleCount?: number,\r\n\t\tuserCount?: number,\r\n\t\tchat?: RoomInfo[],\r\n\t\tsectionTitles?: string[],\r\n\t\tofficial?: RoomInfo[],\r\n\t\tpspl?: RoomInfo[],\r\n\t} = {};\r\n\treceiveLine(args: Args) {\r\n\t\tconst [cmd] = args;\r\n\t\tswitch (cmd) {\r\n\t\tcase 'challstr': {\r\n\t\t\tconst [, challstr] = args;\r\n\t\t\tPSLoginServer.query({\r\n\t\t\t\tact: 'upkeep',\r\n\t\t\t\tchallstr,\r\n\t\t\t}).then(res => {\r\n\t\t\t\tif (!res) return;\r\n\t\t\t\tif (!res.loggedin) return;\r\n\t\t\t\tthis.send(`/trn ${res.username},0,${res.assertion}`);\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t} case 'updateuser': {\r\n\t\t\tconst [, fullName, namedCode, avatar] = args;\r\n\t\t\tPS.user.setName(fullName, namedCode === '1', avatar);\r\n\t\t\treturn;\r\n\t\t} case 'updatechallenges': {\r\n\t\t\tconst [, challengesBuf] = args;\r\n\t\t\tthis.receiveChallenges(challengesBuf);\r\n\t\t\treturn;\r\n\t\t} case 'queryresponse': {\r\n\t\t\tconst [, queryId, responseJSON] = args;\r\n\t\t\tthis.handleQueryResponse(queryId as ID, JSON.parse(responseJSON));\r\n\t\t\treturn;\r\n\t\t} case 'pm': {\r\n\t\t\tconst [, user1, user2, message] = args;\r\n\t\t\tthis.handlePM(user1, user2, message);\r\n\t\t\treturn;\r\n\t\t} case 'formats': {\r\n\t\t\tthis.parseFormats(args);\r\n\t\t\treturn;\r\n\t\t} case 'popup': {\r\n\t\t\tconst [, message] = args;\r\n\t\t\talert(message.replace(/\\|\\|/g, '\\n'));\r\n\t\t\treturn;\r\n\t\t}}\r\n\t\tconst lobby = PS.rooms['lobby'];\r\n\t\tif (lobby) lobby.receiveLine(args);\r\n\t}\r\n\treceiveChallenges(dataBuf: string) {\r\n\t\tlet json;\r\n\t\ttry {\r\n\t\t\tjson = JSON.parse(dataBuf);\r\n\t\t} catch {}\r\n\t\tfor (const userid in json.challengesFrom) {\r\n\t\t\tPS.getPMRoom(toID(userid));\r\n\t\t}\r\n\t\tif (json.challengeTo) {\r\n\t\t\tPS.getPMRoom(toID(json.challengeTo.to));\r\n\t\t}\r\n\t\tfor (const roomid in PS.rooms) {\r\n\t\t\tconst room = PS.rooms[roomid] as ChatRoom;\r\n\t\t\tif (!room.pmTarget) continue;\r\n\t\t\tconst targetUserid = toID(room.pmTarget);\r\n\t\t\tif (!room.challengedFormat && !(targetUserid in json.challengesFrom) &&\r\n\t\t\t\t!room.challengingFormat && json.challengeTo?.to !== targetUserid) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\troom.challengedFormat = json.challengesFrom[targetUserid] || null;\r\n\t\t\troom.challengingFormat = json.challengeTo?.to === targetUserid ? json.challengeTo.format : null;\r\n\t\t\troom.update(null);\r\n\t\t}\r\n\t}\r\n\tparseFormats(formatsList: string[]) {\r\n\t\tlet isSection = false;\r\n\t\tlet section = '';\r\n\r\n\t\tlet column = 0;\r\n\r\n\t\twindow.NonBattleGames = {rps: 'Rock Paper Scissors'};\r\n\t\twindow.BattleFormats = {};\r\n\t\tfor (let j = 1; j < formatsList.length; j++) {\r\n\t\t\tconst entry = formatsList[j];\r\n\t\t\tif (isSection) {\r\n\t\t\t\tsection = entry;\r\n\t\t\t\tisSection = false;\r\n\t\t\t} else if (entry === ',LL') {\r\n\t\t\t\tPS.teams.usesLocalLadder = true;\r\n\t\t\t} else if (entry === '' || (entry.charAt(0) === ',' && !isNaN(Number(entry.slice(1))))) {\r\n\t\t\t\tisSection = true;\r\n\r\n\t\t\t\tif (entry) {\r\n\t\t\t\t\tcolumn = parseInt(entry.slice(1), 10) || 0;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tlet name = entry;\r\n\t\t\t\tlet searchShow = true;\r\n\t\t\t\tlet challengeShow = true;\r\n\t\t\t\tlet tournamentShow = true;\r\n\t\t\t\tlet team: 'preset' | null = null;\r\n\t\t\t\tlet teambuilderLevel: number | null = null;\r\n\t\t\t\tlet lastCommaIndex = name.lastIndexOf(',');\r\n\t\t\t\tlet code = lastCommaIndex >= 0 ? parseInt(name.substr(lastCommaIndex + 1), 16) : NaN;\r\n\t\t\t\tif (!isNaN(code)) {\r\n\t\t\t\t\tname = name.substr(0, lastCommaIndex);\r\n\t\t\t\t\tif (code & 1) team = 'preset';\r\n\t\t\t\t\tif (!(code & 2)) searchShow = false;\r\n\t\t\t\t\tif (!(code & 4)) challengeShow = false;\r\n\t\t\t\t\tif (!(code & 8)) tournamentShow = false;\r\n\t\t\t\t\tif (code & 16) teambuilderLevel = 50;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Backwards compatibility: late 0.9.0 -> 0.10.0\r\n\t\t\t\t\tif (name.substr(name.length - 2) === ',#') { // preset teams\r\n\t\t\t\t\t\tteam = 'preset';\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (name.substr(name.length - 2) === ',,') { // search-only\r\n\t\t\t\t\t\tchallengeShow = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 2);\r\n\t\t\t\t\t} else if (name.substr(name.length - 1) === ',') { // challenge-only\r\n\t\t\t\t\t\tsearchShow = false;\r\n\t\t\t\t\t\tname = name.substr(0, name.length - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet id = toID(name);\r\n\t\t\t\tlet isTeambuilderFormat = !team && name.slice(-11) !== 'Custom Game';\r\n\t\t\t\tlet teambuilderFormat = '' as ID;\r\n\t\t\t\tlet teambuilderFormatName = '';\r\n\t\t\t\tif (isTeambuilderFormat) {\r\n\t\t\t\t\tteambuilderFormatName = name;\r\n\t\t\t\t\tif (id.slice(0, 3) !== 'gen') {\r\n\t\t\t\t\t\tteambuilderFormatName = '[Gen 6] ' + name;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet parenPos = teambuilderFormatName.indexOf('(');\r\n\t\t\t\t\tif (parenPos > 0 && name.slice(-1) === ')') {\r\n\t\t\t\t\t\t// variation of existing tier\r\n\t\t\t\t\t\tteambuilderFormatName = teambuilderFormatName.slice(0, parenPos).trim();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (teambuilderFormatName !== name) {\r\n\t\t\t\t\t\tteambuilderFormat = toID(teambuilderFormatName);\r\n\t\t\t\t\t\tif (BattleFormats[teambuilderFormat]) {\r\n\t\t\t\t\t\t\tBattleFormats[teambuilderFormat].isTeambuilderFormat = true;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tBattleFormats[teambuilderFormat] = {\r\n\t\t\t\t\t\t\t\tid: teambuilderFormat,\r\n\t\t\t\t\t\t\t\tname: teambuilderFormatName,\r\n\t\t\t\t\t\t\t\tteam,\r\n\t\t\t\t\t\t\t\tsection,\r\n\t\t\t\t\t\t\t\tcolumn,\r\n\t\t\t\t\t\t\t\trated: false,\r\n\t\t\t\t\t\t\t\tisTeambuilderFormat: true,\r\n\t\t\t\t\t\t\t\teffectType: 'Format',\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tisTeambuilderFormat = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (BattleFormats[id]?.isTeambuilderFormat) {\r\n\t\t\t\t\tisTeambuilderFormat = true;\r\n\t\t\t\t}\r\n\t\t\t\t// make sure formats aren't out-of-order\r\n\t\t\t\tif (BattleFormats[id]) delete BattleFormats[id];\r\n\t\t\t\tBattleFormats[id] = {\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tname,\r\n\t\t\t\t\tteam,\r\n\t\t\t\t\tsection,\r\n\t\t\t\t\tcolumn,\r\n\t\t\t\t\tsearchShow,\r\n\t\t\t\t\tchallengeShow,\r\n\t\t\t\t\ttournamentShow,\r\n\t\t\t\t\trated: searchShow && id.substr(4, 7) !== 'unrated',\r\n\t\t\t\t\tteambuilderLevel,\r\n\t\t\t\t\tteambuilderFormat,\r\n\t\t\t\t\tisTeambuilderFormat,\r\n\t\t\t\t\teffectType: 'Format',\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Match base formats to their variants, if they are unavailable in the server.\r\n\t\tlet multivariantFormats: {[id: string]: 1} = {};\r\n\t\tfor (let id in BattleFormats) {\r\n\t\t\tlet teambuilderFormat = BattleFormats[BattleFormats[id].teambuilderFormat!];\r\n\t\t\tif (!teambuilderFormat || multivariantFormats[teambuilderFormat.id]) continue;\r\n\t\t\tif (!teambuilderFormat.searchShow && !teambuilderFormat.challengeShow && !teambuilderFormat.tournamentShow) {\r\n\t\t\t\t// The base format is not available.\r\n\t\t\t\tif (teambuilderFormat.battleFormat) {\r\n\t\t\t\t\tmultivariantFormats[teambuilderFormat.id] = 1;\r\n\t\t\t\t\tteambuilderFormat.battleFormat = '';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tteambuilderFormat.battleFormat = id;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tPS.teams.update('format');\r\n\t}\r\n\thandlePM(user1: string, user2: string, message: string) {\r\n\t\tconst userid1 = toID(user1);\r\n\t\tconst userid2 = toID(user2);\r\n\t\tconst roomid = `pm-${[userid1, userid2].sort().join('-')}` as RoomID;\r\n\t\tlet room = PS.rooms[roomid];\r\n\t\tif (!room) {\r\n\t\t\tconst pmTarget = PS.user.userid === userid1 ? user2 : user1;\r\n\t\t\tPS.addRoom({\r\n\t\t\t\tid: roomid,\r\n\t\t\t\tpmTarget,\r\n\t\t\t}, true);\r\n\t\t\troom = PS.rooms[roomid]!;\r\n\t\t}\r\n\t\troom.receiveLine([`c`, user1, message]);\r\n\t\tPS.update();\r\n\t}\r\n\thandleQueryResponse(id: ID, response: any) {\r\n\t\tswitch (id) {\r\n\t\tcase 'userdetails':\r\n\t\t\tlet userid = response.userid;\r\n\t\t\tlet userdetails = this.userdetailsCache[userid];\r\n\t\t\tif (!userdetails) {\r\n\t\t\t\tthis.userdetailsCache[userid] = response;\r\n\t\t\t} else {\r\n\t\t\t\tObject.assign(userdetails, response);\r\n\t\t\t}\r\n\t\t\tconst userRoom = PS.rooms[`user-${userid}`] as UserRoom;\r\n\t\t\tif (userRoom) userRoom.update(null);\r\n\t\t\tbreak;\r\n\t\tcase 'rooms':\r\n\t\t\tthis.roomsCache = response;\r\n\t\t\tconst roomsRoom = PS.rooms[`rooms`] as RoomsRoom;\r\n\t\t\tif (roomsRoom) roomsRoom.update(null);\r\n\t\t\tbreak;\r\n\t\tcase 'roomlist':\r\n\t\t\tconst battlesRoom = PS.rooms[`battles`] as BattlesRoom;\r\n\t\t\tif (battlesRoom) {\r\n\t\t\t\tconst battleTable = response.rooms;\r\n\t\t\t\tconst battles = [];\r\n\t\t\t\tfor (const battleid in battleTable) {\r\n\t\t\t\t\tbattleTable[battleid].id = battleid;\r\n\t\t\t\t\tbattles.push(battleTable[battleid]);\r\n\t\t\t\t}\r\n\t\t\t\tbattlesRoom.battles = battles;\r\n\t\t\t\tbattlesRoom.update(null);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass NewsPanel extends PSRoomPanel {\r\n\trender() {\r\n\t\treturn <PSPanelWrapper room={this.props.room} scrollable>\r\n\t\t\t<div class=\"mini-window-body\" dangerouslySetInnerHTML={{__html: PS.newsHTML}}></div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nclass MainMenuPanel extends PSRoomPanel<MainMenuRoom> {\r\n\tfocus() {\r\n\t\t(this.base!.querySelector('button.big') as HTMLButtonElement).focus();\r\n\t}\r\n\tsubmit = (e: Event) => {\r\n\t\talert('todo: implement');\r\n\t};\r\n\t// handleDragStart = (e: DragEvent) => {\r\n\t// \tconst roomid = (e.currentTarget as HTMLElement).getAttribute('data-roomid') as RoomID;\r\n\t// \tPS.dragging = {type: 'room', roomid};\r\n\t// };\r\n\trenderMiniRoom(room: PSRoom) {\r\n\t\tconst roomType = PS.roomTypes[room.type];\r\n\t\tconst Panel = roomType ? roomType.Component : PSRoomPanel;\r\n\t\treturn <Panel key={room.id} room={room} />;\r\n\t}\r\n\trenderMiniRooms() {\r\n\t\treturn PS.miniRoomList.map(roomid => {\r\n\t\t\tconst room = PS.rooms[roomid]!;\r\n\t\t\treturn <div class=\"pmbox\">\r\n\t\t\t\t<div class=\"mini-window\">\r\n\t\t\t\t\t<h3>\r\n\t\t\t\t\t\t<button class=\"closebutton\" name=\"closeRoom\" value={roomid} aria-label=\"Close\" tabIndex={-1}><i class=\"fa fa-times-circle\"></i></button>\r\n\t\t\t\t\t\t<button class=\"minimizebutton\" tabIndex={-1}><i class=\"fa fa-minus-circle\"></i></button>\r\n\t\t\t\t\t\t{room.title}\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t{this.renderMiniRoom(room)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t});\r\n\t}\r\n\t// renderSearchButton() {\r\n\t// \tif (PS.down) {\r\n\t// \t\treturn <div class=\"menugroup\" style=\"background: rgba(10,10,10,.6)\">\r\n\t// \t\t\t{PS.down === 'ddos' ?\r\n\t// \t\t\t\t<p class=\"error\"><strong>Pok&eacute;mon Showdown is offline due to a DDoS attack!</strong></p>\r\n\t// \t\t\t:\r\n\t// \t\t\t\t<p class=\"error\"><strong>Pok&eacute;mon Showdown is offline due to technical difficulties!</strong></p>\r\n\t// \t\t\t}\r\n\t// \t\t\t<p>\r\n\t// \t\t\t\t<div style={{textAlign: 'center'}}>\r\n\t// \t\t\t\t\t<img width=\"96\" height=\"96\" src={`//${Config.routes.client}/sprites/gen5/teddiursa.png`} alt=\"\" />\r\n\t// \t\t\t\t</div>\r\n\t// \t\t\t\tBear with us as we freak out.\r\n\t// \t\t\t</p>\r\n\t// \t\t\t<p>(We'll be back up in a few hours.)</p>\r\n\t// \t\t</div>;\r\n\t// \t}\r\n\r\n\t// \tif (!PS.user.userid || PS.isOffline) {\r\n\t// \t\treturn <TeamForm class=\"menugroup\" onSubmit={this.submit}>\r\n\t// \t\t\t<button class=\"mainmenu1 big button disabled\" name=\"search\">\r\n\t// \t\t\t\t<em>{PS.isOffline ? \"Disconnected\" : \"Connecting...\"}</em>\r\n\t// \t\t\t</button>\r\n\t// \t\t</TeamForm>;\r\n\t// \t}\r\n\r\n\t// \treturn <TeamForm class=\"menugroup\" onSubmit={this.submit}>\r\n\t// \t\t<button class=\"mainmenu1 big button\" name=\"search\">\r\n\t// \t\t\t<strong>Battle!</strong><br />\r\n\t// \t\t\t<small>Find a random opponent</small>\r\n\t// \t\t</button>\r\n\t// \t</TeamForm>;\r\n\t// }\r\n\trender() {\r\n\t\tconst onlineButton = ' button' + (PS.isOffline ? ' disabled' : '');\r\n\t\tconst searchButton = (PS.down ? <div class=\"menugroup\" style=\"background: rgba(10,10,10,.6)\">\r\n\t\t\t{PS.down === 'ddos' ?\r\n\t\t\t\t<p class=\"error\"><strong>Pok&eacute;mon Showdown is offline due to a DDoS attack!</strong></p>\r\n\t\t\t:\r\n\t\t\t\t<p class=\"error\"><strong>Pok&eacute;mon Showdown is offline due to technical difficulties!</strong></p>\r\n\t\t\t}\r\n\t\t\t<p>\r\n\t\t\t\t<div style={{textAlign: 'center'}}>\r\n\t\t\t\t\t<img width=\"96\" height=\"96\" src={`//${Config.routes.client}/sprites/gen5/teddiursa.png`} alt=\"\" />\r\n\t\t\t\t</div>\r\n\t\t\t\tBear with us as we freak out.\r\n\t\t\t</p>\r\n\t\t\t<p>(We'll be back up in a few hours.)</p>\r\n\t\t</div> : <TeamForm class=\"menugroup\" onSubmit={this.submit}>\r\n\t\t\t<button class={\"mainmenu1 big\" + onlineButton} name=\"search\">\r\n\t\t\t\t<strong>Battle!</strong><br />\r\n\t\t\t\t<small>Find a random opponent</small>\r\n\t\t\t</button>\r\n\t\t</TeamForm>);\r\n\t\treturn <PSPanelWrapper room={this.props.room} scrollable>\r\n\t\t\t<div class=\"mainmenuwrapper\">\r\n\t\t\t\t<div class=\"leftmenu\">\r\n\t\t\t\t\t<div class=\"activitymenu\">\r\n\t\t\t\t\t\t{this.renderMiniRooms()}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"mainmenu\">\r\n\t\t\t\t\t\t{searchButton}\r\n\r\n\t\t\t\t\t\t<div class=\"menugroup\">\r\n\t\t\t\t\t\t\t<p><button class=\"mainmenu2 button\" name=\"joinRoom\" value=\"teambuilder\">Teambuilder</button></p>\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu3\" + onlineButton} name=\"joinRoom\" value=\"ladder\">Ladder</button></p>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"menugroup\">\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu4\" + onlineButton} name=\"joinRoom\" value=\"battles\">Watch a battle</button></p>\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu5\" + onlineButton} name=\"finduser\">Find a user</button></p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"rightmenu\" style={{display: PS.leftRoomWidth ? 'none' : 'block'}}>\r\n\t\t\t\t\t<div class=\"menugroup\">\r\n\t\t\t\t\t\t{PS.server.id === 'showdown' ?\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu1\" + onlineButton} name=\"joinRoom\" value=\"rooms\">Join chat</button></p>\r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t<p><button class={\"mainmenu1\" + onlineButton} name=\"joinRoom\" value=\"lobby\">Join lobby chat</button></p>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"mainmenufooter\">\r\n\t\t\t\t\t<div class=\"bgcredit\"></div>\r\n\t\t\t\t\t<small>\r\n\t\t\t\t\t\t<a href={`//${Config.routes.dex}/`} target=\"_blank\">Pok&eacute;dex</a> | {}\r\n\t\t\t\t\t\t<a href={`//${Config.routes.replays}/`} target=\"_blank\">Replays</a> | {}\r\n\t\t\t\t\t\t<a href={`//${Config.routes.root}/rules`} target=\"_blank\">Rules</a> | {}\r\n\t\t\t\t\t\t<a href={`//${Config.routes.dex}/credits`} target=\"_blank\">Credits</a> | {}\r\n\t\t\t\t\t\t<a href=\"//smogon.com/forums/\" target=\"_blank\">Forum</a>\r\n\t\t\t\t\t</small>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</PSPanelWrapper>;\r\n\t}\r\n}\r\n\r\nclass FormatDropdown extends preact.Component<{format?: string, onChange?: JSX.EventHandler<Event>}> {\r\n\tdeclare base?: HTMLButtonElement;\r\n\tformat = '[Gen 7] Random Battle';\r\n\tchange = (e: Event) => {\r\n\t\tif (!this.base) return;\r\n\t\tthis.format = this.base.value;\r\n\t\tthis.forceUpdate();\r\n\t\tif (this.props.onChange) this.props.onChange(e);\r\n\t};\r\n\trender() {\r\n\t\tif (this.props.format) {\r\n\t\t\treturn <button\r\n\t\t\tname=\"format\" value={this.props.format} class=\"select formatselect preselected\" disabled\r\n\t\t\t>{this.props.format}</button>;\r\n\t\t}\r\n\t\treturn <button\r\n\t\t\tname=\"format\" value={this.format}\r\n\t\t\tclass=\"select formatselect\" data-href=\"/formatdropdown\" onChange={this.change}\r\n\t\t>\r\n\t\t\t{this.format}\r\n\t\t</button>;\r\n\t}\r\n}\r\n\r\nclass TeamDropdown extends preact.Component<{format: string}> {\r\n\tteamFormat = '';\r\n\tteamKey = '';\r\n\tchange = () => {\r\n\t\tif (!this.base) return;\r\n\t\tthis.teamKey = (this.base as HTMLButtonElement).value;\r\n\t\tthis.forceUpdate();\r\n\t};\r\n\tgetDefaultTeam(teambuilderFormat: string) {\r\n\t\tfor (const team of PS.teams.list) {\r\n\t\t\tif (team.format === teambuilderFormat) return team.key;\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\trender() {\r\n\t\tconst teamFormat = PS.teams.teambuilderFormat(this.props.format);\r\n\t\tconst formatData = window.BattleFormats?.[teamFormat];\r\n\t\tif (formatData && formatData.team) {\r\n\t\t\treturn <button class=\"select teamselect preselected\" name=\"team\" value=\"random\" disabled>\r\n\t\t\t\t<div class=\"team\">\r\n\t\t\t\t\t<strong>Random team</strong>\r\n\t\t\t\t\t<small>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t\t<span class=\"picon\" style={Dex.getPokemonIcon(null)}></span>\r\n\t\t\t\t\t</small>\r\n\t\t\t\t</div>\r\n\t\t\t</button>;\r\n\t\t}\r\n\t\tif (teamFormat !== this.teamFormat) {\r\n\t\t\tthis.teamFormat = teamFormat;\r\n\t\t\tthis.teamKey = this.getDefaultTeam(teamFormat);\r\n\t\t}\r\n\t\tconst team = PS.teams.byKey[this.teamKey] || null;\r\n\t\treturn <button\r\n\t\t\tname=\"team\" value={this.teamKey}\r\n\t\t\tclass=\"select teamselect\" data-href=\"/teamdropdown\" data-format={teamFormat} onChange={this.change}\r\n\t\t>\r\n\t\t\t{PS.roomTypes['teamdropdown'] && <TeamBox team={team} noLink />}\r\n\t\t</button>;\r\n\t}\r\n}\r\n\r\nclass TeamForm extends preact.Component<{\r\n\tchildren: preact.ComponentChildren, class?: string, format?: string,\r\n\tonSubmit: null | ((e: Event, format: string, team?: Team) => void),\r\n}> {\r\n\tstate = {format: '[Gen 7] Random Battle'};\r\n\tchangeFormat = (e: Event) => {\r\n\t\tthis.setState({format: (e.target as HTMLButtonElement).value});\r\n\t};\r\n\tsubmit = (e: Event) => {\r\n\t\te.preventDefault();\r\n\t\tconst format = (this.base!.querySelector('button[name=format]') as HTMLButtonElement).value;\r\n\t\tconst teamKey = (this.base!.querySelector('button[name=team]') as HTMLButtonElement).value;\r\n\t\tconst team = teamKey ? PS.teams.byKey[teamKey] : undefined;\r\n\t\tif (this.props.onSubmit) this.props.onSubmit(e, format, team);\r\n\t};\r\n\trender() {\r\n\t\treturn <form class={this.props.class} onSubmit={this.submit}>\r\n\t\t\t<p>\r\n\t\t\t\t<label class=\"label\">\r\n\t\t\t\t\tFormat:<br />\r\n\t\t\t\t\t<FormatDropdown onChange={this.changeFormat} format={this.props.format} />\r\n\t\t\t\t</label>\r\n\t\t\t</p>\r\n\t\t\t<p>\r\n\t\t\t\t<label class=\"label\">\r\n\t\t\t\t\tTeam:<br />\r\n\t\t\t\t\t<TeamDropdown format={this.state.format} />\r\n\t\t\t\t</label>\r\n\t\t\t</p>\r\n\t\t\t<p>{this.props.children}</p>\r\n\t\t</form>;\r\n\t}\r\n}\r\n\r\nPS.roomTypes['news'] = {\r\n\tComponent: NewsPanel,\r\n};\r\n\r\nPS.roomTypes['mainmenu'] = {\r\n\tModel: MainMenuRoom,\r\n\tComponent: MainMenuPanel,\r\n};\r\n"],"mappings":"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"}